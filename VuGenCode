Action()
{
    // Step 1: Get Access Token
    web_add_header("Content-Type", "application/x-www-form-urlencoded");

    web_custom_request("GetToken",
        "URL=https://login.microsoftonline.com/{tenant-id}/oauth2/v2.0/token",
        "Method=POST",
        "Body=grant_type=client_credentials"
            "&client_id={client_id}"
            "&client_secret={client_secret}"
            "&scope=api://{api-client-id}/.default",
        LAST);

    // Save access_token from JSON response
    web_reg_save_param_json(
        "ParamName=AccessToken",
        "QueryString=$.access_token",
        "SelectAll=No",
        LAST);

    // Step 2: Call your API with Bearer token
    web_add_header("Authorization", "Bearer {AccessToken}");
    web_url("CallAPI",
        "URL=https://your-api-host.com/api/endpoint",
        "Method=GET",
        LAST);

    return 0;
}
